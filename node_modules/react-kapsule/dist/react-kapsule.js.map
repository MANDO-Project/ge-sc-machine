{"version":3,"file":"react-kapsule.js","sources":["../node_modules/jerrypick/dist/jerrypick.module.js","../node_modules/fromentries/index.js","../src/index.js"],"sourcesContent":["function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _slicedToArray(arr, i) {\n  return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest();\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _iterableToArrayLimit(arr, i) {\n  var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]);\n\n  if (_i == null) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n\n  var _s, _e;\n\n  try {\n    for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar pluck = function pluck(obj, keys) {\n  return Object.assign.apply(Object, [{}].concat(_toConsumableArray(keys.map(function (key) {\n    return _defineProperty({}, key, obj[key]);\n  }))));\n};\n\nvar omit = function omit(obj, keys) {\n  var keySet = new Set(keys);\n  return Object.assign.apply(Object, [{}].concat(_toConsumableArray(Object.entries(obj).filter(function (_ref2) {\n    var _ref3 = _slicedToArray(_ref2, 1),\n        key = _ref3[0];\n\n    return !keySet.has(key);\n  }).map(function (_ref4) {\n    var _ref5 = _slicedToArray(_ref4, 2),\n        key = _ref5[0],\n        val = _ref5[1];\n\n    return _defineProperty({}, key, val);\n  }))));\n};\n\nexport { omit, pluck };\n","/*! fromentries. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */\nmodule.exports = function fromEntries (iterable) {\n  return [...iterable].reduce((obj, [key, val]) => {\n    obj[key] = val\n    return obj\n  }, {})\n}\n","import React, {\n  useState,\n  useEffect,\n  useLayoutEffect,\n  useRef,\n  useMemo,\n  useCallback,\n  forwardRef,\n  useImperativeHandle\n} from 'react';\n\nimport { omit } from 'jerrypick';\n\nimport fromEntries from 'fromentries';\n\nexport default function(kapsuleComponent, comboParam, ...restArgs) {\n\n  const {\n    wrapperElementType = 'div',\n    nodeMapper = node => node,\n    methodNames = [],\n    initPropNames = []\n  } = typeof comboParam === 'object'\n    ? comboParam\n    : { // support old schema for backwards compatibility\n      wrapperElementType: comboParam,\n      methodNames: restArgs[0] || undefined,\n      initPropNames: restArgs[1] || undefined\n    };\n\n  return forwardRef((props, ref) => {\n    const domEl = useRef();\n\n    const [prevProps, setPrevProps] = useState({});\n    useEffect(() => setPrevProps(props)); // remember previous props\n\n    // instantiate the inner kapsule component with the defined initPropNames\n    const comp = useMemo(() => {\n      const configOptions = fromEntries(\n        initPropNames\n          .filter(p => props.hasOwnProperty(p))\n          .map(prop => [prop, props[prop]])\n      );\n\n      return kapsuleComponent(configOptions);\n    }, []);\n\n    useLayoutEffect(() => {\n      comp(nodeMapper(domEl.current)); // mount kapsule synchronously on this element ref, optionally mapped into an object that the kapsule understands\n    }, []);\n\n    useEffect(() => {\n      // invoke destructor on unmount, if it exists\n      return comp._destructor instanceof Function ? comp._destructor : undefined;\n    }, []);\n\n    // Call a component method\n    const _call = useCallback((method, ...args) =>\n      comp[method] instanceof Function\n        ? comp[method](...args)\n        : undefined // method not found\n    , [comp]);\n\n    // propagate component props that have changed\n    const dynamicProps = omit(props, [...methodNames, ...initPropNames]); // initPropNames or methodNames should not be called\n    Object.keys(dynamicProps)\n      .filter(p => prevProps[p] !== props[p])\n      .forEach(p => _call(p, props[p]));\n\n    // bind external methods to parent ref\n    useImperativeHandle(ref, () => fromEntries(\n      methodNames.map(method =>\n        [\n          method,\n          (...args) => _call(method, ...args)\n        ]\n      )\n    ));\n\n    return React.createElement(wrapperElementType, { ref: domEl });\n  });\n}\n"],"names":["kapsuleComponent","comboParam","wrapperElementType","methodNames","undefined","initPropNames","nodeMapper","node","forwardRef","props","ref","domEl","useRef","useState","prevProps","setPrevProps","useEffect","comp","useMemo","configOptions","fromEntries","filter","p","hasOwnProperty","map","prop","useLayoutEffect","current","_destructor","Function","_call","useCallback","method","args","dynamicProps","omit","Object","keys","forEach","useImperativeHandle","React","createElement"],"mappings":"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"}