{"ast":null,"code":"var vg = require('../../lib/hex-grid.min.js');\n\nvar defaultHexGrid = require('../../lib/default-hex-grid');\n/**\n * Hex grid.\n */\n\n\nmodule.exports.Primitive = AFRAME.registerPrimitive('a-hexgrid', {\n  defaultComponents: {\n    'hexgrid': {}\n  },\n  mappings: {\n    src: 'hexgrid.src'\n  }\n});\nmodule.exports.Component = AFRAME.registerComponent('hexgrid', {\n  dependencies: ['material'],\n  schema: {\n    src: {\n      type: 'asset'\n    }\n  },\n  init: function init() {\n    var _this = this;\n\n    var data = this.data;\n\n    if (data.src) {\n      fetch(data.src).then(function (response) {\n        return response.json();\n      }).then(function (json) {\n        return _this.addMesh(json);\n      });\n    } else {\n      this.addMesh(defaultHexGrid);\n    }\n  },\n  addMesh: function addMesh(json) {\n    var grid = new vg.HexGrid();\n    grid.fromJSON(json);\n    var board = new vg.Board(grid);\n    board.generateTilemap();\n    this.el.setObject3D('mesh', board.group);\n    this.addMaterial();\n  },\n  addMaterial: function addMaterial() {\n    var materialComponent = this.el.components.material;\n    var material = (materialComponent || {}).material;\n    if (!material) return;\n    this.el.object3D.traverse(function (node) {\n      if (node.isMesh) {\n        node.material = material;\n      }\n    });\n  },\n  remove: function remove() {\n    this.el.removeObject3D('mesh');\n  }\n});","map":null,"metadata":{},"sourceType":"script"}