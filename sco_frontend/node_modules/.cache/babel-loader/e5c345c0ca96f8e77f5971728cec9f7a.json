{"ast":null,"code":"var _require = require('three-pathfinding'),\n    Pathfinding = _require.Pathfinding;\n\nvar pathfinder = new Pathfinding();\nvar ZONE = 'level';\n/**\n * nav\n *\n * Pathfinding system, using PatrolJS.\n */\n\nmodule.exports = AFRAME.registerSystem('nav', {\n  init: function init() {\n    this.navMesh = null;\n    this.agents = new Set();\n  },\n\n  /**\n   * @param {THREE.Geometry} geometry\n   */\n  setNavMeshGeometry: function setNavMeshGeometry(geometry) {\n    this.navMesh = new THREE.Mesh(geometry);\n    pathfinder.setZoneData(ZONE, Pathfinding.createZone(geometry));\n    Array.from(this.agents).forEach(function (agent) {\n      return agent.updateNavLocation();\n    });\n  },\n\n  /**\n   * @return {THREE.Mesh}\n   */\n  getNavMesh: function getNavMesh() {\n    return this.navMesh;\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  addAgent: function addAgent(ctrl) {\n    this.agents.add(ctrl);\n  },\n\n  /**\n   * @param {NavAgent} ctrl\n   */\n  removeAgent: function removeAgent(ctrl) {\n    this.agents.delete(ctrl);\n  },\n\n  /**\n   * @param  {THREE.Vector3} start\n   * @param  {THREE.Vector3} end\n   * @param  {number} groupID\n   * @return {Array<THREE.Vector3>}\n   */\n  getPath: function getPath(start, end, groupID) {\n    return this.navMesh ? pathfinder.findPath(start, end, ZONE, groupID) : null;\n  },\n\n  /**\n   * @param {THREE.Vector3} position\n   * @return {number}\n   */\n  getGroup: function getGroup(position) {\n    return this.navMesh ? pathfinder.getGroup(ZONE, position) : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} position\n   * @param  {number} groupID\n   * @return {Node}\n   */\n  getNode: function getNode(position, groupID) {\n    return this.navMesh ? pathfinder.getClosestNode(position, ZONE, groupID, true) : null;\n  },\n\n  /**\n   * @param  {THREE.Vector3} start Starting position.\n   * @param  {THREE.Vector3} end Desired ending position.\n   * @param  {number} groupID\n   * @param  {Node} node\n   * @param  {THREE.Vector3} endTarget (Output) Adjusted step end position.\n   * @return {Node} Current node, after step is taken.\n   */\n  clampStep: function clampStep(start, end, groupID, node, endTarget) {\n    if (!this.navMesh) {\n      endTarget.copy(end);\n      return null;\n    } else if (!node) {\n      endTarget.copy(end);\n      return this.getNode(end, groupID);\n    }\n\n    return pathfinder.clampStep(start, end, node, ZONE, groupID, endTarget);\n  }\n});","map":null,"metadata":{},"sourceType":"script"}