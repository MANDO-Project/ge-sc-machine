{"ast":null,"code":"/**\n * Source: https://github.com/Adobe-Marketing-Cloud/fetch-script\n */\nfunction getScriptId() {\n  return 'script_' + Date.now() + '_' + Math.ceil(Math.random() * 100000);\n}\n\nfunction createScript(url, id) {\n  var script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.async = true;\n  script.id = id;\n  script.src = url;\n  return script;\n}\n\nfunction removeScript(id) {\n  var script = document.getElementById(id);\n  var parent = script.parentNode;\n\n  try {\n    parent && parent.removeChild(script);\n  } catch (e) {// ignore\n  }\n}\n\nfunction appendScript(script) {\n  var firstScript = document.getElementsByTagName('script')[0];\n  firstScript.parentNode.insertBefore(script, firstScript);\n}\n\nfunction fetchScriptInternal(url, options, Promise) {\n  return new Promise(function (resolve, reject) {\n    var timeout = options.timeout || 5000;\n    var scriptId = getScriptId();\n    var script = createScript(url, scriptId);\n    var timeoutId = setTimeout(function () {\n      reject(new Error('Script request to ' + url + ' timed out'));\n      removeScript(scriptId);\n    }, timeout);\n\n    var disableTimeout = function disableTimeout(timeoutId) {\n      clearTimeout(timeoutId);\n    };\n\n    script.addEventListener('load', function (e) {\n      resolve({\n        ok: true\n      });\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n    script.addEventListener('error', function (e) {\n      reject(new Error('Script request to ' + url + ' failed ' + e));\n      disableTimeout(timeoutId);\n      removeScript(scriptId);\n    });\n    appendScript(script);\n  });\n}\n\nfunction fetchScript(settings) {\n  settings = settings || {};\n  return function (url, options) {\n    options = options || {};\n    return fetchScriptInternal(url, options, settings.Promise || Promise);\n  };\n}\n\nmodule.exports = fetchScript;","map":null,"metadata":{},"sourceType":"script"}